{"singlePage": [], "startSite": "", "filingNum": "", "onePageListNum": 15, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "themeMode": "manual", "dayTheme": "light", "nightTheme": "dark", "urlMode": "pinyin", "script": "", "style": "", "indexScript": "", "indexStyle": "", "bottomText": "", "showPostSource": 1, "iconList": {}, "UTC": 8, "rssSplit": "sentence", "exlink": {}, "needComment": 1, "title": "weng\u7684\u535a\u5ba2", "subTitle": "\u8bb0\u5f55\u4e00\u4e9b\u6709\u8da3\u7684\u4e8b\u513f~", "avatarUrl": "https://avatars.githubusercontent.com/u/154400523?v=4", "GMEEK_VERSION": "last", "postListJson": {"P2": {"htmlDir": "docs/post/da-shu-ju-qi-mo-fu-xi.html", "labels": ["documentation"], "postTitle": "\u5927\u6570\u636e\u671f\u672b\u590d\u4e60", "postUrl": "post/da-shu-ju-qi-mo-fu-xi.html", "postSourceUrl": "https://github.com/weng235/weng23.github.io/issues/2", "commentNum": 0, "wordCount": 729, "description": "### RDD\u6c42\u5e73\u5747\u6570\r\n\r\n```\r\nval gradeRDD = sc.textFile('D:\\\\DeskData\\\\1.txt')\r\n\r\n// \u7edf\u8ba1\u6bcf\u4e2a\u5b66\u751f\u7684\u5e73\u5747\u6210\u7ee9\r\nval avgGrade = gradeRDD.map(line => {\r\n  val fields = line.split(' ')\r\n  (fields(0), fields(1).toFloat)\r\n}).reduceByKey(_ + _).map(x => (x._1, (x._2 / 3).formatted('%.2f')))\r\navgGrade.foreach(println)\r\n\r\n// \u4fdd\u5b58\u4e3a\u6587\u4ef6\r\navgGrade.saveAsTextFile('D:\\\\wer\\\\DeskData\\\\2.txt')\r\n```\r\n\r\n### \u5206\u7ec4\uff0c\u7ec4\u5185\u503c\u6392\u5e8f\u53d6\u524d\u4e09\r\n\r\n```\r\n    val data = sc.textFile('D:\\\\wer\\\\DeskData\\\\1.txt')\r\n    val result = data.map(line => {\r\n        val fields = line.split(' ')\r\n        (fields(0), fields(1).toInt)\r\n      })\r\n      // \u73ed\u7ea7\u524d\u4e09\u540d\r\n      .groupByKey().mapValues(iter => iter.toList.sortWith(_ > _).take(3))\r\n      // \u6392\u5e8f\u73ed\u7ea7\r\n      .sortByKey()\r\n\r\n    result.foreach(println)\r\n```\r\n\u3002", "top": 0, "createdAt": 1719225852, "style": "", "script": "", "ogImage": "https://avatars.githubusercontent.com/u/154400523?v=4", "createdDate": "2024-06-24", "dateLabelColor": "#bc4c00"}}, "singeListJson": {}, "labelColorDict": {"bug": "#d73a4a", "documentation": "#0075ca", "duplicate": "#cfd3d7", "enhancement": "#a2eeef", "good first issue": "#7057ff", "help wanted": "#008672", "invalid": "#e4e669", "question": "#d876e3", "wontfix": "#ffffff"}, "displayTitle": "weng\u7684\u535a\u5ba2", "faviconUrl": "https://avatars.githubusercontent.com/u/154400523?v=4", "ogImage": "https://avatars.githubusercontent.com/u/154400523?v=4", "primerCSS": "<link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />", "homeUrl": "https://weng235.github.io/weng23.github.io", "prevUrl": "disabled", "nextUrl": "disabled"}