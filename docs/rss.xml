<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>weng的博客</title><link>https://weng235.github.io/weng23.github.io</link><description>记录一些有趣的事儿~</description><copyright>weng的博客</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://avatars.githubusercontent.com/u/154400523?v=4</url><title>avatar</title><link>https://weng235.github.io/weng23.github.io</link></image><lastBuildDate>Tue, 25 Jun 2024 06:20:10 +0000</lastBuildDate><managingEditor>weng的博客</managingEditor><ttl>60</ttl><webMaster>weng的博客</webMaster><item><title>大数据期末复习</title><link>https://weng235.github.io/weng23.github.io/post/da-shu-ju-qi-mo-fu-xi.html</link><description>### RDD求平均数&#13;
&#13;
```&#13;
val gradeRDD = sc.textFile('D:\\DeskData\\1.txt')&#13;
&#13;
// 统计每个学生的平均成绩&#13;
val avgGrade = gradeRDD.map(line =&gt; {&#13;
  val fields = line.split(' ')&#13;
  (fields(0), fields(1).toFloat)&#13;
}).reduceByKey(_ + _).map(x =&gt; (x._1, (x._2 / 3).formatted('%.2f')))&#13;
avgGrade.foreach(println)&#13;
&#13;
// 保存为文件&#13;
avgGrade.saveAsTextFile('D:\\wer\\DeskData\\2.txt')&#13;
```&#13;
&#13;
### 分组，组内值排序取前三&#13;
&#13;
```&#13;
    val data = sc.textFile('D:\\wer\\DeskData\\1.txt')&#13;
    val result = data.map(line =&gt; {&#13;
        val fields = line.split(' ')&#13;
        (fields(0), fields(1).toInt)&#13;
      })&#13;
      // 班级前三名&#13;
      .groupByKey().mapValues(iter =&gt; iter.toList.sortWith(_ &gt; _).take(3))&#13;
      // 排序班级&#13;
      .sortByKey()&#13;
&#13;
    result.foreach(println)&#13;
```&#13;
。</description><guid isPermaLink="true">https://weng235.github.io/weng23.github.io/post/da-shu-ju-qi-mo-fu-xi.html</guid><pubDate>Mon, 24 Jun 2024 10:44:12 +0000</pubDate></item></channel></rss>